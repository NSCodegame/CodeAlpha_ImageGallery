// Image and video data (auto-generated from image folder)
const media = [
  { src: 'image/8045821-hd_1080_1920_25fps.mp4', type: 'video', category: 'Videos' },
  { src: 'image/4678261-hd_1080_1920_25fps.mp4', type: 'video', category: 'Videos' },
  { src: 'image/7302969-hd_1080_1920_25fps.mp4', type: 'video', category: 'Videos' },
  { src: 'image/14076812_3840_2160_30fps.mp4', type: 'video', category: 'Videos' },
  { src: 'image/pexels-alaritammsalu-33046569.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-alexfu-1302436.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-alexfu-3289156.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-aleksey-kuprikov-1883853-3551234.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-apasaric-2341830.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-apasaric-2385210.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-ashutoshvarma-11539627.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-athena-1760459.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-baraa-jalahej-691192-3751387.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-bastien-neves-2459695-13208277.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-bertellifotografia-2868224.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-bertellifotografia-573238.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-brenoanp-442535-1136575.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-busenur-demirkan-766536648-33052460.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-chad-simbajon-30182-115553.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-clement-couturier-546640561-32802262.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-clement-couturier-546640561-32802262 (1).jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-clive-kim-2523249-4220967.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-dhanno-32633198.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-didsss-1276429.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-eberhardgross-1417647.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-eberhardgross-1624496.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-ecem-arslan-2150733147-33053049.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-edward-532643054-33056398.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-esan-2085998.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-f4photography-1317365.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-falling4utah-1080953.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-frank-cone-140140-3279307.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-freestockpro-2070485.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-guillermo-arroyo-1166930-2225759.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-guilherme-494791-1724376.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-haydan-as-soendawy-730525-2928867.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-iriser-1707213.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-jonathanborba-2888488.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-jonathanborba-2888492.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-josh-hild-1270765-3333923.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-koprivakart-3511571.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-lstan-2666154.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-lukebarky-2407130.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-lysenkow-2301177.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-maria-loznevaya-249159277-13244141.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-mastercowley-2489474.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-matthew-ang-52745-1327786.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-maxandrey-1207732.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-neale-lasalle-197020-631477.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-pixabay-509246.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-postiglioni-2376799.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-rabiahanim-8045905.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-rakicevic-nenad-233369-1274260.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-samkolder-2387877.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-sanaan-3075993.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-shndgd-33053082.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-skyriusmarketing-2129796.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-souvenirpixels-1539225.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-souvenirpixels-1539225 (1).jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-stefanstefancik-42148.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-susan-flores-232226967-33027948.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-susan-flores-232226967-33027948 (1).jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-thevibrantmachine-3066867.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-thomas-balabaud-735585-32390716.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-tobiasbjorkli-1562058.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-tomfisk-13232119.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-valeriya-7646667.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-vladbagacian-1368382.jpg', type: 'image', category: 'Image' },
  { src: 'image/pexels-willsantos-2714627.jpg', type: 'image', category: 'Image' },
];

const categories = ['All', ...Array.from(new Set(media.map(m => m.category)))];
let currentFilter = 'All';
let currentIndex = 0;

const gallery = document.querySelector('.gallery');
const filters = document.querySelector('.filters');
const lightbox = document.querySelector('.lightbox');
const lightboxContent = document.querySelector('.lightbox-content');
const closeBtn = document.querySelector('.lightbox .close');
const prevBtn = document.querySelector('.lightbox .prev');
const nextBtn = document.querySelector('.lightbox .next');

function renderFilters() {
  filters.innerHTML = '';
  categories.forEach(cat => {
    const btn = document.createElement('button');
    btn.textContent = cat;
    btn.className = cat === currentFilter ? 'active' : '';
    // Add data-icon for CSS icons
    if (cat === 'All') btn.setAttribute('data-icon', 'all');
    else btn.setAttribute('data-icon', cat);
    btn.onclick = () => {
      currentFilter = cat;
      renderFilters();
      renderGallery();
    };
    filters.appendChild(btn);
  });
}

function renderGallery() {
  gallery.innerHTML = '';
  const filtered = currentFilter === 'All' ? media : media.filter(m => m.category === currentFilter);
  filtered.forEach((item, idx) => {
    const div = document.createElement('div');
    div.className = 'gallery-item';
    div.tabIndex = 0;
    div.setAttribute('data-index', media.indexOf(item));
    if (item.type === 'image') {
      const img = document.createElement('img');
      img.src = item.src;
      img.alt = item.category;
      div.appendChild(img);
    } else if (item.type === 'video') {
      const vid = document.createElement('video');
      vid.src = item.src;
      vid.muted = true;
      vid.loop = true;
      vid.autoplay = true;
      vid.playsInline = true;
      div.appendChild(vid);
    }
    div.onclick = () => openLightbox(media.indexOf(item));
    gallery.appendChild(div);
  });
}

function openLightbox(idx) {
  currentIndex = idx;
  updateLightbox();
  lightbox.classList.add('active');
  // Force reflow for fade-in
  void lightbox.offsetWidth;
  lightbox.style.opacity = '1';
  document.body.style.overflow = 'hidden';
}

function closeLightbox() {
  lightbox.classList.remove('active');
  lightbox.style.opacity = '0';
  document.body.style.overflow = '';
}

function prevMedia() {
  currentIndex = (currentIndex - 1 + media.length) % media.length;
  updateLightbox();
}

function nextMedia() {
  currentIndex = (currentIndex + 1) % media.length;
  updateLightbox();
}

function updateLightbox() {
  const item = media[currentIndex];
  lightboxContent.innerHTML = '';
  if (item.type === 'image') {
    const img = document.createElement('img');
    img.src = item.src;
    img.alt = item.category;
    lightboxContent.appendChild(img);
  } else if (item.type === 'video') {
    const vid = document.createElement('video');
    vid.src = item.src;
    vid.controls = true;
    vid.autoplay = true;
    vid.style.maxHeight = '80vh';
    lightboxContent.appendChild(vid);
  }
  const heightSlider = document.querySelector('.height-slider');
  if (heightSlider) {
    const mediaElement = lightboxContent.querySelector('img, video');
    if (mediaElement) {
      // Set initial slider value
      const currentHeight = (mediaElement.offsetHeight / window.innerHeight) * 100;
      heightSlider.value = currentHeight > 100 ? 100 : currentHeight;

      // Update media height on slider input
      heightSlider.oninput = () => {
        mediaElement.style.height = `${heightSlider.value}vh`;
        mediaElement.style.maxHeight = `${heightSlider.value}vh`;
      };
    }
  }
}

closeBtn.onclick = closeLightbox;
prevBtn.onclick = prevMedia;
nextBtn.onclick = nextMedia;

lightbox.addEventListener('click', e => {
  if (e.target === lightbox) closeLightbox();
});
document.addEventListener('keydown', e => {
  if (!lightbox.classList.contains('active')) return;
  if (e.key === 'Escape') closeLightbox();
  if (e.key === 'ArrowLeft') prevMedia();
  if (e.key === 'ArrowRight') nextMedia();
});

// Initial render
document.addEventListener('DOMContentLoaded', () => {
  renderFilters();
  renderGallery();

  // Surprise Me button
  const surpriseBtn = document.querySelector('.surprise-btn');
  if (surpriseBtn) {
    surpriseBtn.onclick = () => {
      const idx = Math.floor(Math.random() * media.length);
      openLightbox(idx);
    };
  }
}); 